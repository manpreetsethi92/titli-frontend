{"ast":null,"code":"import{useState,useEffect,createContext,useContext}from\"react\";import\"./App.css\";import{BrowserRouter,Routes,Route,Navigate}from\"react-router-dom\";import axios from\"axios\";import{Toaster}from\"./components/ui/sonner\";// Pages\nimport LandingPage from\"./pages/LandingPage\";import DashboardLayout from\"./pages/DashboardLayout\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const BACKEND_URL=process.env.REACT_APP_BACKEND_URL||\"http://localhost:8000\";export const API=\"\".concat(BACKEND_URL,\"/api\");// Auth Context\nconst AuthContext=/*#__PURE__*/createContext(null);export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error(\"useAuth must be used within AuthProvider\");}return context;};const AuthProvider=_ref=>{let{children}=_ref;const[user,setUser]=useState(null);const[token,setToken]=useState(localStorage.getItem(\"titly_token\"));const[loading,setLoading]=useState(true);const[showAuthModal,setShowAuthModal]=useState(false);useEffect(()=>{const fetchUser=async()=>{if(token){try{const response=await axios.get(\"\".concat(API,\"/users/me\"),{headers:{Authorization:\"Bearer \".concat(token)}});setUser(response.data);}catch(error){console.error(\"Failed to fetch user:\",error);localStorage.removeItem(\"titly_token\");setToken(null);}}setLoading(false);};fetchUser();},[token]);const login=(newToken,userData)=>{localStorage.setItem(\"titly_token\",newToken);setToken(newToken);setUser(userData);};const logout=()=>{localStorage.removeItem(\"titly_token\");setToken(null);setUser(null);};const updateUser=userData=>{setUser(userData);};const openAuthModal=()=>setShowAuthModal(true);const closeAuthModal=()=>setShowAuthModal(false);const value={user,token,loading,login,logout,updateUser,isAuthenticated:!!token&&!!user,showAuthModal,openAuthModal,closeAuthModal};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};// Protected Route\nconst ProtectedRoute=_ref2=>{let{children}=_ref2;const{isAuthenticated,loading,user}=useAuth();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-white\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})});}if(!isAuthenticated||user&&!user.profile_completed){return/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true});}return children;};function App(){return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsx(BrowserRouter,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(LandingPage,{})}),/*#__PURE__*/_jsx(Route,{path:\"/app/*\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(DashboardLayout,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})})]})}),/*#__PURE__*/_jsx(Toaster,{position:\"top-center\",richColors:true})]})});}export default App;","map":{"version":3,"names":["useState","useEffect","createContext","useContext","BrowserRouter","Routes","Route","Navigate","axios","Toaster","LandingPage","DashboardLayout","jsx","_jsx","jsxs","_jsxs","BACKEND_URL","process","env","REACT_APP_BACKEND_URL","API","concat","AuthContext","useAuth","context","Error","AuthProvider","_ref","children","user","setUser","token","setToken","localStorage","getItem","loading","setLoading","showAuthModal","setShowAuthModal","fetchUser","response","get","headers","Authorization","data","error","console","removeItem","login","newToken","userData","setItem","logout","updateUser","openAuthModal","closeAuthModal","value","isAuthenticated","Provider","ProtectedRoute","_ref2","className","profile_completed","to","replace","App","path","element","position","richColors"],"sources":["/Users/tajsethi/Desktop/titli-local/src/App.js"],"sourcesContent":["import { useState, useEffect, createContext, useContext } from \"react\";\nimport \"./App.css\";\nimport { BrowserRouter, Routes, Route, Navigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { Toaster } from \"./components/ui/sonner\";\n\n// Pages\nimport LandingPage from \"./pages/LandingPage\";\nimport DashboardLayout from \"./pages/DashboardLayout\";\n\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL || \"http://localhost:8000\";\nexport const API = `${BACKEND_URL}/api`;\n\n// Auth Context\nconst AuthContext = createContext(null);\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth must be used within AuthProvider\");\n  }\n  return context;\n};\n\nconst AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [token, setToken] = useState(localStorage.getItem(\"titly_token\"));\n  const [loading, setLoading] = useState(true);\n  const [showAuthModal, setShowAuthModal] = useState(false);\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      if (token) {\n        try {\n          const response = await axios.get(`${API}/users/me`, {\n            headers: { Authorization: `Bearer ${token}` }\n          });\n          setUser(response.data);\n        } catch (error) {\n          console.error(\"Failed to fetch user:\", error);\n          localStorage.removeItem(\"titly_token\");\n          setToken(null);\n        }\n      }\n      setLoading(false);\n    };\n    fetchUser();\n  }, [token]);\n\n  const login = (newToken, userData) => {\n    localStorage.setItem(\"titly_token\", newToken);\n    setToken(newToken);\n    setUser(userData);\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"titly_token\");\n    setToken(null);\n    setUser(null);\n  };\n\n  const updateUser = (userData) => {\n    setUser(userData);\n  };\n\n  const openAuthModal = () => setShowAuthModal(true);\n  const closeAuthModal = () => setShowAuthModal(false);\n\n  const value = {\n    user,\n    token,\n    loading,\n    login,\n    logout,\n    updateUser,\n    isAuthenticated: !!token && !!user,\n    showAuthModal,\n    openAuthModal,\n    closeAuthModal\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\n// Protected Route\nconst ProtectedRoute = ({ children }) => {\n  const { isAuthenticated, loading, user } = useAuth();\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-white\">\n        <div className=\"spinner\"></div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated || (user && !user.profile_completed)) {\n    return <Navigate to=\"/\" replace />;\n  }\n\n  return children;\n};\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <div className=\"app-container\">\n        <BrowserRouter>\n          <Routes>\n            <Route path=\"/\" element={<LandingPage />} />\n            <Route \n              path=\"/app/*\" \n              element={\n                <ProtectedRoute>\n                  <DashboardLayout />\n                </ProtectedRoute>\n              } \n            />\n            <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n          </Routes>\n        </BrowserRouter>\n        <Toaster position=\"top-center\" richColors />\n      </div>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}